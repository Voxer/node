From 51f8b1d339ca6977f91f7a2a658fa8de0e9652eb Mon Sep 17 00:00:00 2001
From: George Kola <georgekola@gmail.com>
Date: Sat, 19 Oct 2013 04:19:14 +0000
Subject: [PATCH] Passing in sockaddr so that we can use DTrace and figure out
 who is connecting to our node server easily

---
 deps/uv/src/unix/core.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/deps/uv/src/unix/core.c b/deps/uv/src/unix/core.c
index f3636e2..ffce481 100644
--- a/deps/uv/src/unix/core.c
+++ b/deps/uv/src/unix/core.c
@@ -428,6 +428,9 @@ int uv__accept(int sockfd) {
   int peerfd;
 
   assert(sockfd >= 0);
+  struct sockaddr addr;
+  socklen_t socklen = sizeof(addr);
+  memset(&addr,0,sizeof(addr));
 
   while (1) {
 #if __linux__
@@ -454,7 +457,7 @@ int uv__accept(int sockfd) {
 skip:
 #endif
 
-    peerfd = accept(sockfd, NULL, NULL);
+    peerfd = accept(sockfd, &addr, &socklen);
 
     if (peerfd == -1) {
       if (errno == EINTR)
-- 
1.8.4

